
$Cred_font = "686868"

$data = @CRLF & "[size=35][b]ISN AutoIt Studio[/b][/size]" & @CRLF & _
		"- Version " & $Studioversion & " -" & @CRLF & @CRLF & @CRLF & @CRLF & _
		"[size=20][b]" & _Get_langstr(181) & "[/b][/size]" & @CRLF & _
		"[c=#" & $Cred_font & "]ISI360 (Christian Faderl)[/c] " & @CRLF & @CRLF & @CRLF & _
		"[size=20][b]" & _Get_langstr(182) & "[/b][/size][c=#" & $Cred_font & "]" & @CRLF & @CRLF & _
		"Chatbox UDF [b](by TheShadowAE and Oscar)[/b]" & @CRLF & @CRLF & _
		"_ShowFileProperties  [b](by Rasim)[/b]" & @CRLF & @CRLF & _
		"_GUICtrlTreeView_ExpandOneLevel [b](by BugFix)[/b]" & @CRLF & @CRLF & _
		"_SciLexer [b](by lokster,ProgAndy,Miachael Michta,Kip,Jos,PrideRage [thx to the scintilla team!] )[/b]" & @CRLF & @CRLF & _
		"_API_SetLayeredWindowAttributes [b](by ProgAndy)[/b]" & @CRLF & @CRLF & _
		"_RegisterFileType [b](by bernd670)[/b]" & @CRLF & @CRLF & _
		"_FileDeleteAfterXDays [b](by Oscar & Micha_he)[/b]" & @CRLF & @CRLF & _
		"TreeView Explorer Control UDF [b](by Yashied)[/b]" & @CRLF & @CRLF & _
		"_ReduceMemory [b](by w_Outer, Rajesh V R & ProgAndy)[/b]" & @CRLF & @CRLF & _
		"_TargetQueryStyles [b](by Chase/Xenogis - Modified by Quaizywabbit)[/b]" & @CRLF & @CRLF & _
		"installfont [b](by vinci91)[/b]" & @CRLF & @CRLF & _
		"_ButtonHover.au3 [b](by Valuater, Robert M)[/b]" & @CRLF & @CRLF & _
		"_FileOperationProgress [b](by teh_hahn, SumTingWong, lod3n)[/b]" & @CRLF & @CRLF & _
		"Zip32.au3 [b](by R.Gilman (a.k.a. rasim))[/b]" & @CRLF & @CRLF & _
		"Performance Counters [b](by Ascend4nt)[/b]" & @CRLF & @CRLF & _
		"WinAPIEx.au3 [b](by Yashied)[/b]" & @CRLF & @CRLF & _
		"_MonitorEnumProc [b](by xrxca)[/b]" & @CRLF & @CRLF & _
		"USkin.au3 [b](by ProgAndy)[/b]" & @CRLF & @CRLF & _
		"ColorChooser.au3 [b](by Yashied)[/b]" & @CRLF & @CRLF & _
		"_DrawGrid [b](by BuckMaster)[/b]" & @CRLF & @CRLF & _
		"_GUICtrlListView_SaveCSV [b](by guinness & ProgAndy)[/b]" & @CRLF & @CRLF & _
		"AutoIt3Wrapper [b](by Jos van der Zande)[/b]" & @CRLF & @CRLF & _
		"_GUICtrlListView_MoveItems [b](by G.Sandler a.k.a CreatoR)[/b]" & @CRLF & @CRLF & _
		"_ArraySort_MultiColumn [b](by UEZ)[/b]" & @CRLF & @CRLF & _
		"Bitwise operations visualiser [b](by Siao)[/b]" & @CRLF & @CRLF & _
		"_TristateTreeViewLib [b](by Holger Kotsch)[/b]" & @CRLF & @CRLF & _
		"StringMatchAndGet [b](by kcvinu)[/b]" & @CRLF & @CRLF & _
		"_WinAPI_ProcessGetFilename [b](by Ascend4nt)[/b]" & @CRLF & @CRLF & _
		"_AdlibEnhance [b](by JScript (João Carlos))[/b]" & @CRLF & @CRLF & _
		"_FindInFile [b](by guinness)[/b]" & @CRLF & @CRLF & _
		"InIVirtual [b](by AZJIO)[/b]" & @CRLF & @CRLF & _
		"Icon UDF [b](by Yashied)[/b]" & @CRLF & @CRLF & _
		"Curl.au3 [b](by Ward)[/b]" & @CRLF & @CRLF & _
		"Json.au3 [b](by Ward)[/b]" & @CRLF & @CRLF & _
		"RDC UDF [b](by Yashied)[/b]" & @CRLF & @CRLF & _
		"MultiGraph UDF [b](by SBond)[/b]" & @CRLF & @CRLF & _
		"GUIScrollBars_Ex [b](by Melba23)[/b]" & @CRLF & @CRLF & _
		"Hotkey UDF [b](by Yashied)[/b]" & @CRLF & @CRLF & _
		"_RunWithReducedPrivileges [b](by Ascend4nt)[/b]" & @CRLF & @CRLF & _
		"Dbug - Another debugger for AutoIt [b](by valdemar1977, Heron, asdf8 and pandel)[/b]" & @CRLF & @CRLF & _
		"AutoIt3 WildcardMatch [b](by Prasetyo Priadi)[/b]" & @CRLF & @CRLF & _
		"PredictText [b](by Phoenix XL)[/b][/c] " & @CRLF & @CRLF & _
		"" & @CRLF & _
		"[size=20][b]" & _Get_langstr(316) & "[/b][/size]" & @CRLF & _
		"[c=#" & $Cred_font & "]Two Steps From Hell - For the Win[/c] " & @CRLF & @CRLF & @CRLF & _
		"[size=20][b]" & _Get_langstr(322) & "[/b][/size]" & @CRLF & _
		"[c=#" & $Cred_font & "]Copyright by Sony Corporation[/c] " & @CRLF & @CRLF & @CRLF & _
		"[size=20][b]" & _Get_langstr(401) & "[/b][/size]" & @CRLF & _
		"[c=#" & $Cred_font & "]chrisatack" & @CRLF & _
		"BLinz" & @CRLF & _
		"TheLuBu" & @CRLF & _
		"BasicOs" & @CRLF & _
		"RyperX" & @CRLF & _
		"inventor" & @CRLF & _
		"Mr.Geheim" & @CRLF & _
		"pandel" & @CRLF & _
		"misterspeed" & @CRLF & _
		"fantec" & @CRLF & _
		"kcvinu" & @CRLF & _
		"Rex" & @CRLF & _
		"BugFix" & @CRLF & _
		"BuckMaster" & @CRLF & _
		"bfgxp" & @CRLF & _
		"Bartosz Wójcik" & @CRLF & _
		"Deye" & @CRLF & _
		"ISN_Fan" & @CRLF & _
		"LarsJ" & @CRLF & _
		"Dave Thijse" & @CRLF & _
		"Bitnugger" & @CRLF & _
		"[/c] " & @CRLF & _
		"[size=20][b]" & _Get_langstr(402) & "[/b][/size]" & @CRLF & @CRLF & @CRLF & _
		"[size=20][b]" & _Get_langstr(753) & "[/b][/size]" & @CRLF & _
		"[c=#" & $Cred_font & "]Matthias A." & @CRLF & _
		"Bastian F." & @CRLF & _
		"Stefan J." & @CRLF & _
		"Andreas R." & @CRLF & _
		"Lars P. M." & @CRLF & _
		"Christophe B." & @CRLF & _
		"Claudio M. T." & @CRLF & _
		"Marko S." & @CRLF & _
		"Christian S." & @CRLF & _
		"Jan H. B." & @CRLF & _
		"Rocco C." & @CRLF & _
		"Andreas B." & @CRLF & _
		"Dennis M." & @CRLF & _
		"Stefano S." & @CRLF & _
		"Udo G." & @CRLF & _
		"Johnny R. K." & @CRLF & _
		"Alexander S." & @CRLF & _
		"Christian P." & @CRLF & _
		"Ralf W." & @CRLF & _
		"Maxime V." & @CRLF & _
		"Frank B." & @CRLF & _
		"Mike J." & @CRLF & _
		"Sebastian W." & @CRLF & _
		"Thomas E." & @CRLF & _
		"Hendrik G." & @CRLF & _
		"Hans-J. F." & @CRLF & _
		"Jermaine T." & _
		"Charles M." & _
		"[/c] " & @CRLF & _
		"[size=20][b]" & _Get_langstr(754) & "[/b][/size]" & @CRLF & @CRLF & @CRLF & _
		"[size=20][b]" & _Get_langstr(183) & "[/b][/size]" & @CRLF & @CRLF & @CRLF & _
		"[size=20][b]" & _Get_langstr(317) & "[/b][/size]" & @CRLF & @CRLF & @CRLF & _
		"[size=20][b]" & _Get_langstr(184) & "[/b][/size]" & @CRLF & _
		"https://www.isnetwork.at" & @CRLF & @CRLF & @CRLF

;"[c=#FF0000]Moin,[/c] schwarz"&@CRLF



Func _ChatBoxCreate_Credits($gui, $txt = "", $x = 0, $y = 0, $w = 100, $h = 100, $bgc = "0xFFFFFF", $readonly = True, $autodetecturl = True)

	Local $ret ;RichEdit

	$ret = _GUICtrlRichEdit_Create($gui, "", $x, $y, $w, $h, BitOR($ES_MULTILINE, $WS_VSCROLL, $ES_CENTER, $ES_AUTOVSCROLL), 0)
	_GUICtrlRichEdit_AutoDetectURL($ret, $autodetecturl)
	_GUICtrlRichEdit_SetLimitOnText($ret, -1)
	_GUICtrlRichEdit_SetBkColor($ret, $bgc)
	_GUICtrlRichEdit_SetReadOnly($ret, $readonly)

	If $txt <> "" Then _ChatBoxAdd($ret, $txt)
	Return $ret
EndFunc   ;==>_ChatBoxCreate_Credits


$CreditsGUI = GUICreate(_Get_langstr(176) & " " & _Get_langstr(1), 800 * $DPI, 413 * $DPI, -1, -1, BitOR($WS_CAPTION, $WS_POPUP, $WS_SYSMENU), $ISN_WS_EX_MDICHILD, $Studiofenster)
Global $hToolTip_CreditsGUI = _GUIToolTip_Create($CreditsGUI)
_GUISetIcon($CreditsGUI, $smallIconsdll, 1596)
_CenterOnMonitor($CreditsGUI, "", $Runonmonitor)
GUISetOnEvent($GUI_EVENT_CLOSE, "_Hide_Credits", $CreditsGUI)
GUISetBkColor(0xFFFFFF)
GUICtrlCreatePic(@ScriptDir & "\Data\credits.jpg", 0, 0, 800, 413)
_Control_set_DPI_Scaling(-1)
GUICtrlSetState(-1, $GUI_DISABLE)
$Credits_Lautsprecher_label = GUICtrlCreateLabel("", 707, 6, 30, 40, $SS_CENTER + $SS_CENTERIMAGE)
_Control_set_DPI_Scaling($Credits_Lautsprecher_label)
_GUIToolTip_AddTool($hToolTip_CreditsGUI, 0, _Get_langstr(900),GUICtrlGetHandle($Credits_Lautsprecher_label))
GUICtrlSetColor($Credits_Lautsprecher_label, 0xFF0000)
GUICtrlSetFont($Credits_Lautsprecher_label, 25, 400, 0, "Tahoma")
GUICtrlSetOnEvent($Credits_Lautsprecher_label, "_Credits_Musik_Stumm_toggle")
GUICtrlSetBkColor($Credits_Lautsprecher_label, -2)
GUICtrlSetCursor($Credits_Lautsprecher_label, 0)
$credits_speed_button = GUICtrlCreateLabel("", 747, 6, 35, 40)
GUICtrlSetBkColor($credits_speed_button, -2)
_Control_set_DPI_Scaling($credits_speed_button)
_GUIToolTip_AddTool($hToolTip_CreditsGUI, 0, _Get_langstr(901),GUICtrlGetHandle($credits_speed_button))
GUICtrlSetOnEvent($credits_speed_button, "_Credits_beschlaunigen")
GUICtrlSetCursor($credits_speed_button, 0)


$CreditsGUI2 = GUICreate("", 800 * $DPI, 413 * $DPI, 0, 0, $WS_POPUP, 0x00080000 + $WS_EX_MDICHILD, $CreditsGUI)
GUISetBkColor(0xFFFFFF)
$Credits_Srollbox = _ChatBoxCreate_Credits($CreditsGUI2, "", 0, 413 * $DPI, 800 * $DPI, 1900 * $DPI, "0xFFFFFF", True, True)
_GUICtrlRichEdit_AppendText($Credits_Srollbox, ReadBmpToRtf(@ScriptDir & "\Data\isn_logo_s.bmp") & @CR)
_GUICtrlRichEdit_SetFont($Credits_Srollbox, 11, "Verdana")
_ChatBoxAdd($Credits_Srollbox, $data)
_GUICtrlRichEdit_AppendText($Credits_Srollbox, ReadBmpToRtf(@ScriptDir & "\Data\isi360_logo_s.bmp") & @CR)
_GUICtrlRichEdit_SetFont($Credits_Srollbox, 11, "Segoe Script")
_ChatBoxAdd($Credits_Srollbox, @CRLF & @CRLF & "[size=33][b]Thanks for using the ISN AutoIt Studio![/b][/size]" & @CR)

_GUICtrlRichEdit_SetEventMask($Credits_Srollbox, $ENM_LINK)
_GUICtrlRichEdit_AutoDetectURL($Credits_Srollbox, True)
_WinAPI_SetLayeredWindowAttributes($CreditsGUI2, 0xFFFFFF)

Func _Credits_Musik_Stumm_toggle()
	If _SoundStatus($Creditsmusik) = "playing" Then
		GUICtrlSetData($Credits_Lautsprecher_label, "X")
		_SoundPause($Creditsmusik)
	Else
		GUICtrlSetData($Credits_Lautsprecher_label, "")
		_SoundResume($Creditsmusik)
	EndIf
EndFunc   ;==>_Credits_Musik_Stumm_toggle

Func _Credits_beschlaunigen()
	While _IsPressed("01", $user32)
		$Credits_Scrollgeschwindigkeit = 8
		Sleep(10)
	WEnd
	$Credits_Scrollgeschwindigkeit = 1

EndFunc   ;==>_Credits_beschlaunigen

Func ReadBmpToRtf($sBmpFilspc)
	Local $hFile, $sRtf
	$hFile = FileOpen($sBmpFilspc, 16)
	If FileRead($hFile, 2) <> "0x424D" Then Return SetError(1, 0, "")
	FileRead($hFile, 12)
	$sRtf = '{\rtf1{\pict\dibitmap ' & Hex(FileRead($hFile)) & '}}'
	FileClose($hFile)
	Return $sRtf
EndFunc   ;==>ReadBmpToRtf

Func FindFirstBMP($sPath = @WindowsDir)
	Local $hFind, $sBmpFilspc
	$hFind = FileFindFirstFile($sPath & "\*.bmp")
	$sBmpFilspc = FileFindNextFile($hFind)
	FileClose($hFind)
	Return $sPath & "\" & $sBmpFilspc
EndFunc   ;==>FindFirstBMP


Func WM_NOTIFY_Scroll($hWnd, $iMsg, $iWparam, $iLparam)
	#forceref $hWnd, $iMsg, $iWparam
	Local $hWndFrom, $iCode, $tNMHDR, $tEnLink, $cpMin, $cpMax, $tMsgFilter
	$tNMHDR = DllStructCreate($tagNMHDR, $iLparam)
	$hWndFrom = HWnd(DllStructGetData($tNMHDR, "hWndFrom"))
	$iCode = DllStructGetData($tNMHDR, "Code")
	Switch $hWndFrom
		Case $Credits_Srollbox
			Select
				Case $iCode = $EN_LINK
					$tMsgFilter = DllStructCreate($tagMSGFILTER, $iLparam)
					If DllStructGetData($tMsgFilter, "msg") = $WM_LBUTTONUP Then
						$tEnLink = DllStructCreate($tagENLINK, $iLparam)
						$cpMin = DllStructGetData($tEnLink, "cpMin")
						$cpMax = DllStructGetData($tEnLink, "cpMax")
						_Hide_Credits()
						ShellExecute(_GUICtrlRichEdit_GetTextInRange($Credits_Srollbox, $cpMin, $cpMax))
					EndIf
			EndSelect
	EndSwitch
	Return $GUI_RUNDEFMSG
EndFunc   ;==>WM_NOTIFY_Scroll


Func _Start_scrolling()
	$pos = ControlGetPos($CreditsGUI, "", $Credits_Srollbox)
	$new = $pos[1] - $Credits_Scrollgeschwindigkeit
	_WinAPI_MoveWindow($Credits_Srollbox, 0, $new, 800 * $DPI, 3800 * $DPI)
EndFunc   ;==>_Start_scrolling

Func _Show_Credits()
	GUISetState(@SW_HIDE, $Welcome_GUI)
	GUICtrlSetData($Credits_Lautsprecher_label, "")
	_WinAPI_MoveWindow($Credits_Srollbox, 0, 413 * $DPI, 800 * $DPI, 3800 * $DPI)
;~ 	_WinAPI_MoveWindow($Credits_Srollbox, 0, 413, 588, 1400)
	;_WinAPI_MoveWindow($Credits_Srollbox, 0,(@DesktopHeight/2),@DesktopWidth,1500)
	GUISetState(@SW_DISABLE, $StudioFenster)
	;GUISetState(@SW_SHOW,$Blackframe_GUI)
;~ 	GUIRegisterMsg($WM_NOTIFY, "WM_NOTIFY_Scroll")
	GUISetState(@SW_SHOW, $CreditsGUI)
	GUISetState(@SW_SHOW, $CreditsGUI2)
	WinSetOnTop($CreditsGUI, "", 1)
	_SoundPlay($Creditsmusik, 0)
;~ 	SoundPlay (@ScriptDir&"\Data\credits.mp3",0)

	AdlibRegister("_Start_scrolling", 30)
;~ 	_Start_scrolling()
EndFunc   ;==>_Show_Credits

Func _Hide_Credits()
	AdlibUnRegister("_Start_scrolling")
	_SoundStop($Creditsmusik)
	If $Offenes_Projekt = "" Then
		GUISetState(@SW_SHOW, $Welcome_GUI)
	Else
		GUISetState(@SW_ENABLE, $StudioFenster)
;~ 		GUIRegisterMsg($WM_NOTIFY, '_WM_NOTIFY')
	EndIf
	GUISetState(@SW_HIDE, $CreditsGUI)
	GUISetState(@SW_HIDE, $CreditsGUI2)

EndFunc   ;==>_Hide_Credits


;===============================================================================
;
; Function Name:   _API_SetLayeredWindowAttributes
; Description:: Sets Layered Window Attributes:) See MSDN for more informaion
; Parameter(s):
;                 $hwnd - Handle of GUI to work on
;                 $i_transcolor - Transparent color
;                 $Transparency - Set Transparancy of GUI
;                 $isColorRef - If True, $i_transcolor is a COLORREF-Strucure, else an RGB-Color
; Requirement(s):  Layered Windows
; Return Value(s): Success: 1
;                 Error: 0
;                  @error: 1 to 3 - Error from DllCall
;                  @error: 4 - Function did not succeed - use
;                              _WinAPI_GetLastErrorMessage or _WinAPI_GetLastError to get more information
; Author(s):       Prog@ndy
;
;===============================================================================
;
Func _API_SetLayeredWindowAttributes($hWnd, $i_transcolor, $Transparency = 255, $isColorRef = False)

	Local Const $AC_SRC_ALPHA = 1
	Local Const $ULW_ALPHA = 2
	Local Const $LWA_ALPHA = 0x2
	Local Const $LWA_COLORKEY = 0x1
	If Not $isColorRef Then
		$i_transcolor = Hex(String($i_transcolor), 6)
		$i_transcolor = Execute('0x00' & StringMid($i_transcolor, 5, 2) & StringMid($i_transcolor, 3, 2) & StringMid($i_transcolor, 1, 2))
	EndIf
	Local $ret = DllCall("user32.dll", "int", "SetLayeredWindowAttributes", "hwnd", $hWnd, "long", $i_transcolor, "byte", $Transparency, "long", $LWA_COLORKEY + $LWA_ALPHA)
	Select
		Case @error
			Return SetError(@error, 0, 0)
		Case $ret[0] = 0
			Return SetError(4, 0, 0)
		Case Else
			Return 1
	EndSelect
EndFunc   ;==>_API_SetLayeredWindowAttributes


